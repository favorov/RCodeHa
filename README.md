Code for Patrik Ha's project